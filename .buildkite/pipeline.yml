steps:
  - label: ":test_tube::hammer: Test & Build"
    commands:
      - mvn test
      - ops/bins/build
    artifact_paths: target/libs/*
    plugins:
      - docker#v3.8.0:
          image: "openjdk:11-jre-slim"
    agents:
      queue: myob-rest-api-agent

  - wait
  - label: ":rocket: Deploy"
    branches: master
    command: ops/bins/deploy
    retry:
      manual:
        permit_on_passed: true
    agents:
      queue: myob-rest-api-agent
